{% extends "base.html" %}
{% load staticfiles %}
{% block main %}
	<div id="header">
		<div class="grid">
			<div class="grid__item one-whole desk-two-thirds float-left">
				<h1><span class="smaller">The </span>Housing Guide</h1>
			</div><!--
		 --><div class="grid__item one-whole desk-one-third no-padding">
				<div id="search-container">
					<label for="searchbox"><span class="delta">Search</span><span class="epsilon"> by dorm name</span></label>
					<input id="searchbox" type="text" data-provide="typeahead" autocomplete="off">	
				</div>
			</div>
		</div>
	</div>

	<div class="grid">
		<div class="grid__item one-whole desk-three-quarters float-right">
			<div>
				<h2>East Fairchild (Communications Residential College)</h2>
				<p class="body-text">East Fairchild, also known as Communications Residential College, is a smaller dorm geared toward students interested in journalism, film and media. Located on the southern tip of campus, the hall houses mostly freshmen and sophomores.</p>
			</div>
			<div class="padding-top">
				<h3>Look inside</h3>
				<div id="photo-tab" class="tab float-left" >
					<img src="{% static 'img/photo-icon.png' %}">
					<p>Photo</p>
				</div>
				<div id="video-tab" class="tab float-left">
          <img src="{% static 'img/video-icon.png' %}">
					<p>Video</p>
				</div>
				<div id="photo-container" class="clear">
					<img src="{% static 'img/1.jpg' %}">
				</div>
				<div class="padding-top">
					<h3>Vital stats</h3>
					<div class="stats-item">
						<p class="body-text">South campus</p>
						<p class="body-text"><span class="number">0.7</span> miles from Tech</p>
						<p class="body-text"><span class="number">0.5</span> miles from Norris</p>
						<p class="body-text"><span class="number">0.4</span> miles from Kresge</p>
						<p class="body-text"><span class="number">0.3</span> miles from Burger King</p>
					</div>
					<div class="stats-item">
						<p class="body-text">100 doubles</p>
						<p class="body-text">+ 10 singles</p>
						<hr>
						<p class="body-text">110 residents</p>
					</div>
					<div class="stats-item">
						<p class="body-text">No A.C.</p>
						<p class="body-text">Closest dining hall: Hinman
						<p class="body-text">Residential college</p>
						<p class="body-text">$2642 per quarter</p>
					</div>
					<div class="stats-item">
            <svg class="chart">
            </svg>
					</div>
				</div>
				<div class="padding-top">
					<h3>What residents say</h3>
					<p class="body-text">"Very clique-y. If you're not an RTVF major, you will feel left out. The sophomores are already best friends so it's hard for the freshmen to fit in."</p>
					<p class="body-text">"Most in the dorm are RTVF or journalism majors, which makes it very nice for those people, but other majors are not left out either. CRC has a lot of very cool traditions."</p>
					<p class="body-text">"This dorm should have been renovated twenty years ago. An alum came back who lived here in the 80s and said he had the same furniture."</p>
					<p class="body-text">"It's super close to all south classes, so you can roll out of bed at 8:53 and get to a 9 am class with a minute to breathe."</p>
					<p class="body-text">"Everyone here only hangs out with/parties with/talks to /sleeps with people here. It's also very nerdy and into things like video games, comic books, internet memes, etc."</p>
					<p class="body-text">"If you are fairly sarcastic, enjoy messing with people, internet memes, and don't necessarily need to party 24/7, CRC is a great dorm."</p>
					<p class="body-text">"The people are really interesting, but having such a small, tight-knit, family-like community can also mean that fights and bullshit and divisions all get blown up much larger than they need to be."</p>
					<p class="body-text">"Very social, trusting, and weird. It definitely has its own fun, unique culture."</p>
				</div>
			</div>
		</div>
		<div class="grid__item one-whole desk-one-quarter float-left">
			<div>
				<h4><a href="../index.html">&laquo; Go back</a></h4>
			</div>
			<div id="small-map">
			</div>
			<h3 class="padding-top">Room size</h3>
			<img src="{% static 'img/room.jpg' %}">
		</div>
	</div>
	<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
    <script src="{% static 'js/leaflet-providers.js' %}"></script>
    <script type="text/javascript">
      var geojson;
      var map = L.map('small-map').setView([42.05504447993239,-87.6753830909729], 16);
      L.tileLayer.provider('MapQuestOpen.OSM').addTo(map);
      $.getJSON('{% url "home" %}', function(data){
            parse_map_data(data);
        });
      function parse_map_data(data){
        $.each(data, function(key, val){
            geojson = new L.GeoJSON(val, {
              onEachFeature: onEachFeature
            }).addTo(map);
        });
    }
    function onEachFeature(feature, layer) {
        // does this feature have a property named popupContent?
        if (feature.properties && feature.properties.name) {
            layer.bindPopup(feature.properties.name);
        }
    }

    // D3.js bar chart for class distributions
    var w = 240,
    h = 100,
    x = d3.scale.ordinal().rangeRoundBands([0, h-1])
    y = d3.scale.linear().range([0, w-1])
    z = d3.scale.ordinal().range(['lightblue', 'lightpink']);

    var data = [
      {'male': 23, 'female': 19},
      {'male': 11, 'female': 12},
      {'male': 8, 'female': 9},
      {'male': 2, 'female': 1}
    ];
    var genders = d3.layout.stack()(['male', 'female'].map(
      function(gender) {
        return data.map(function(d, i) {
          return {x: i, y: +d[gender]};
        });
      })
    );
    var classes = ['Freshmen', 'Sophomores', 'Juniors', 'Seniors'];

    var chart = d3.select(".chart")
                  .attr("width", w)
                  .attr("height", h)
                  .append("svg:g");
    x.domain(genders[0].map(function(d) { return d.x }));
    y.domain([0, d3.max(genders[genders.length - 1], function(d) {
        return d.y0 + d.y; })]);

    var gender = chart.selectAll("g.gender")
      .data(genders)
      .enter().append("svg:g")
      .attr("class", "gender")
      .style("fill", function(d, i) { return z(i); })
      .style("stroke", function(d, i) { return d3.rgb(z(i)).darker(); });
    
    // Draw rectangles
    var rect = gender.selectAll("rect")
      .data(Object)
      .enter().append("svg:rect")
      .attr("x", function(d) { return y(d.y0); })
      .attr("y", function(d) { return x(d.x); })
      .attr("height", x.rangeBand())
      .attr("width", function(d) { return y(d.y); });

    // Label bars by class
    chart.selectAll("text")
      .data(data)
      .enter().append("svg:text")
      .attr("y", function(d, i) { return x(i) + x.rangeBand() / 2; })
      .attr("dx", 6)
      .attr("dy", ".35em")
      .attr("text-anchor", "begin")
      .text(function(d, i) { return classes[i]; });

    </script>
{% endblock %}
